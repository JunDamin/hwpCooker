<style>
    p {
        margin: 10px;
        padding: 10px;
    }

    .container {
        position: relative;
        width: 900px;
        border-style: solid;
        border-color: darkgray;
        border-radius: 40px;
        border-width: 4px;
        margin: 5px;
        padding: 10px;
    }
</style>
<div class="container">
    <h1 id="빵틀-v.0.2-소개">빵틀 v.0.2 소개</h1>
    <h2 id="개발배경">개발배경</h2>
    <p>문서작업을 하면서 같은 형식의 문서를 여러장 만들어야 하는 경우가 발생합니다. 그렇게 단순 반복적인 업무를 효율적으로 수행하기 위해 Data와 Template라는 관계를 활용하여 반복작업을 자동화 하고자
        했습니다.</p>
    <p>이 도구는 Excel과 아래아한글을 연계하는 것을 목표로 개발하였으며 이런 연계를 통해 업무 효율이 개선되지 않을까 기대하고 있습니다.</p>
    <h2 id="기본원리">기본원리</h2>
    <p>기본적으로 Data를 Template에 맵핑하여 문서를 생성합니다. 즉 엑셀에 있는 각 행을 한글 Template에 주어진 위치에 반영하는 것인데요. 엑셀의 첫번째 행의 값을 한글에서 찾아바꾸기를 하는
        것과 거의 같은 행동을 반복합니다.</p>
    <figure>
        <img src="manual/excel_data.png" alt="엑셀 파일형식입니다." width="800" />
        <figcaption>엑셀 파일형식입니다.</figcaption>
    </figure>
    <p>예를 들어 A1의 값은 &quot;__파일명__“, B1의 값이”[이름]“, A2의 값은”01. 홍길동“, B2의 값이”홍길동“이라고 한다면 엑셀파일의 두번째 행 작업이 진행될 때 한글에서
        Template파일을 열고”[이름]“을”홍길동“으로 찾아바꾸기를 한다고 보시면 됩니다. 그리고 그 파일을”01. 홍길동.hwp“라는 파일로 저장한다고 보시면 됩니다. 그리고 A3의 값이”02.
        전다민“, B3의 값이”전다민“이면 두번째 파일”02. 전다민.hwp&quot;를 생성한다고 보시면 됩니다.</p>
    <figure>
        <img src="manual/template_format.png" alt="한글Template에 엑셀 첫째행의 값들로 맵핑합니다." width="800" />
        <figcaption>한글Template에 엑셀 첫째행의 값들로 맵핑합니다.</figcaption>
    </figure>
    <p>즉 어디에 어떤 자료가 들어가는지 엑셀 첫째 행 값을 활용해 한글Template에 맵핑 할 수 있다면 빵틀을 만들어 같은 모양의 빵을 구워내듯이 문서를 찍어낼 수 있습니다.</p>
    <figure>
        <img src="manual/GeneratedFiles.png" alt="생성된 한글파일" width="800" />
        <figcaption>생성된 한글파일</figcaption>
    </figure>
    <figure>
        <img src="manual/output_result.png" alt="맵핑에 맞춰 값이 바뀌어 있다." width="800" />
        <figcaption>맵핑에 맞춰 값이 바뀌어 있다.</figcaption>
    </figure>
    <h2 id="사례-1.-수령증이-필요할-때">사례 1. 수령증이 필요할 때</h2>
    <p>사무소에서 현지평가회의를 하거나 출장단이 오는 경우 수령증을 만들어야 하는 경우가 생깁니다. 거의 같은 형식에 성함과 금액만 다른 같은 형식의 문서를 생성하게 되는데요. 아무래도 반복하게 되다보면 금액을
        잘못 기재하거나 바꿔야 하는 부분을 놓치는 위험이 커지게 됩니다.</p>
    <ol type="1">
        <li>엑셀에 지급해야 하는 사람들의 이름과 금액, 산출근거를 입력합니다.</li>
        <li>Template를 디자인 합니다.</li>
        <li>빵틀을 실행시키고 데이터와 Template를 지정하고 테스트를 해봅니다.</li>
        <li>원하는 형식으로 완성이 된 경우 파일을 구워 냅니다.</li>
        <li>생성된 경로를 열어구워진 파일에 이상이 없는지 확인하고 출력하여 사용합니다. <img src="manual/data_sample1.png" alt="자료구조를 확인합니다."
                width="800" /> <img src="manual/template_sample1.png" alt="탬플릿 디자인을 확인합니다." width="800" /> <img
                src="manual/result_sample1.png" alt="결과물을 확인합니다." width="800" /></li>
    </ol>
    <p>이럴 때 엑셀 파일에 정보를 정리하고 Template을 만들어서 작업하게 되면 오류를 줄일 수 있게 됩니다.</p>
    <h2 id="사례-2.-지표를-관리할-때">사례 2. 지표를 관리할 때</h2>
    <p>일반적으로 지표 등을 관리할 때는 전체 취합된 엑셀 파일을 가지고 관리 합니다. 그렇게 해야지만 달성도 등을 확인하기 쉽고 정리할 수 있기 때문이죠. 하지만 지표 현황을 보고할 때는 보통 한글자료를
        사용하게 됩니다. 아무래도 길고 긴 엑셀표는 가독성이 떨어질 수 밖에 없기 때문입니다.</p>
    <p>이렇게 자료형식과 보고형식이 별도로 존재하는 경우 보고를 위한 행정소요가 급증하게 됩니다. 보고자료를 만들 때마다 단순히 모여 있는 자료를 형식에 맞춘 표에 옮기는데에만 몇시간씩 추가적인 문서작업에만
        소요가 되버리는 것이죠. 이렇게 같은 형식으로 작성되는 문서는 자동화 할 수 있는 여지가 있습니다.</p>
    <ol type="1">
        <li>관리하고 있는 지표자료에 첫째행에 입력할 값의 이름을 지정합니다. 특히 &quot;__파일명__&quot;이 첫째 열에 있어야 파일이 생성이 됩니다.</li>
        <li>Template를 디자인 합니다.(반복되는 형식 단위를 파악하여 어디가 값이 바뀌는지 지정합니다)</li>
        <li>빵틀을 실행시키고 데이터와 Template를 지정하고 테스트를 해봅니다.</li>
        <li>원하는 형식으로 완성이 된 경우 파일을 구워 냅니다.</li>
        <li>생성된 경로를 열어 구워진 파일에 이상이 없는지 확인하고 완성된 한글파일을 문서작성에 활용합니다.</li>
    </ol>
    <p>참고로, 한컴에서 제공하는 플러그인을 활용하면 쉽게 문서를 병합할 수 있습니다.</p>
    <h2 id="사용시-주의사항">사용시 주의사항</h2>
    <h2 id="산출물-검사-필수">산출물 검사 필수!</h2>
    <p>이런 도구는 마치 마법사의 빗자루와 같이 멍청하게 극단적으로 반복하기 때문에 Template에 문제가 있거나 데이터 관리에 문제가 있어도 검증하지 못하고 시킨대로만 반복합니다. 그렇기 때문에 출력된 자료
        중 일부를 샘플링하여 제대로 되었는지 확인할 필요가 있으며 신뢰도가 중요한 자료의 경우 반드시 전수점검을 해야 합니다.</p>
    <p>이런 추가적인 절차에도 불구하고 기존 방식보다 훨씬 더 신속하게 작업을 할 수 있습니다.</p>
    <h1 id="개발환경">개발환경</h1>
    <p>파이썬으로 개발한 다음 PYINSTALLER로 감싸 배포버전을 만들었다. 사용하는 파이썬 버전은 3.7.4. 32-bit 이다.</p>
    <h2 id="사용패키지">사용패키지</h2>
    <ul>
        <li>데이터 처리
            <ul>
                <li>numpy</li>
                <li>pandas</li>
                <li>xlrd</li>
            </ul>
        </li>
        <li>그래픽 인터페이스
            <ul>
                <li>PySimpleGUI</li>
            </ul>
        </li>
        <li>아래아한글파일 처리
            <ul>
                <li>pywin32</li>
                <li>lxml</li>
            </ul>
        </li>
        <li>내장패키지
            <ul>
                <li>os</li>
                <li>time</li>
                <li>re</li>
            </ul>
        </li>
    </ul>
    <h2 id="에디터">에디터</h2>
    <p>기본적으로 visual studio code를 에디터로 사용하였다. 기본제공되는 기능이외 사용했던 확장기능은 아래와 같다.</p>
    <ul>
        <li>black(포맷잡아주는 기능)</li>
        <li>flake8(스타일 오류 잡아주는 기능)</li>
    </ul>
    <h2 id="아이디어">아이디어</h2>
    <p>탬플릿에 자료가 들어가 문서가 생성되는 기능을 구현해본다.</p>
    <ul>
        <li>엑셀자료를 읽어온다.</li>
        <li>읽어온 자료를 한글 Template에 집어 넣는다.
            <ul>
                <li>한글 Template는 hwp문서를 사용해서 한글문서 편집기능을 사용한다.</li>
                <li>hwp자체는 활용이 어려우므로 hml로 변환해서 xml구조로 사용한다.</li>
                <li>hml로 파일을 생성하고 hwp로 변환한다.</li>
                <li>hwp 관련 변환은 아래아한글 프로그램 API를 사용한다.</li>
            </ul>
        </li>
    </ul>
</div>